---
title: "EDLD 651 Final Project"
author: "Jon Benedik Bunquin, Nafisul Huq, and Faria Shaikh"
format: html
editor: visual
warning: False
embed-resources: true
toc: true
bibliography: references.bib
---

# Abstract

# Introduction

# Methods

```{r}
## Imports

#| echo: false

#install.packages("devtools")
#install.packages("vdemdata")

library(vdemdata)
library(dplyr)
library(skimr)
library(tidyverse)
library(ggplot2)
vdem <- vdem
```

## Data Processing

### Data Filtering

```{r}
vdemdata <- vdem %>%
  filter(country_name == "Bangladesh" | 
           country_name == "Philippines" |
           country_name == "Pakistan" |
           country_name == "United States of America") %>%
  select(country_name, 
         year, 
         v2x_frassoc_thick,
         v2xel_frefair,
         v2x_freexp_altinf,
         v2x_elecoff,
         v2x_suffr) %>%
  filter(year >= 1971) %>% 
  rename(freedom_association=v2x_frassoc_thick,
         clean_elections=v2xel_frefair,
         freedom_expression=v2x_freexp_altinf,
         elected_index=v2x_elecoff,
         suffrage=v2x_suffr)

head(vdemdata)

```

### Data Exploration

```{r}
skim(vdemdata)
```

<insert interpretation here>

### Data Cleaning

```{r}
vdemdata_long <- vdemdata %>%
  pivot_longer(
    cols = 3:5,
    names_to = 'criteria',
    values_to = 'score'
    )

head(vdemdata_long)
```

# Results

## Individual Country Results

### Bangladesh

```{r}
vdemdata_long %>%
  filter(country_name == 'Bangladesh') %>% 
  ggplot(aes(x = year, y = score, color = criteria)) +
  geom_point() +
  geom_line() + 
  geom_vline(xintercept = c(1975,1980,1990,2000,2007,2013)) + 
  annotate("text", x=c(1974,1979,1989,1999,2006,2012), y=0.1,label=c("Before 1975","1980","1990","2000","2007","2013"), 
           color="tomato4",size=2.5, angle=90) + 
  labs(title = 'Electoral Democracy in the Bangladesh from 1971 to 2022',
       subtitle = 'Trends in electoral democracy index scores over the last 50 years',
       x = 'Year',
       y = 'Index Score',
       color = 'Index',
       caption = 'Data Source: Varieties of Democracy (https://www.v-dem.net)') +
  scale_color_manual(values = c("#d8b365", "#2c7fb8", "#5ab4ac"),
                    labels = c('Clean election', 'Freedom of association', 'Freedom of expression')) + 
  theme_minimal() +
  theme(plot.caption = element_text(hjust = 0))
  
```

### Pakistan

```{r}

vdemdata_long %>%
  filter(country_name == 'Pakistan') %>% 
  ggplot(aes(x = year, y = score, color = criteria)) +
  geom_point() +
  geom_line() + geom_vline(xintercept = c(1971,1977,1988,1999,2008)) + 
  annotate("text", x=c(1970,1976,1986,1998,2007), y=0.1,label=c("Before 1971","1977","1988","1999","2008"),
           color="tomato4",size=2.5, angle=90) +
  labs(title = 'Electoral Democracy in the Pakistan from 1971 to 2022',
       subtitle = 'Trends in electoral democracy index scores over the last 50 years',
       x = 'Year',
       y = 'Index Score',
       color = 'Index',
       caption = 'Data Source: Varieties of Democracy (https://www.v-dem.net)') +
  scale_color_manual(values = c("#d8b365", "#2c7fb8", "#5ab4ac"),
                    labels = c('Clean election', 'Freedom of association', 'Freedom of expression')) + 
  theme_minimal() +
  theme(plot.caption = element_text(hjust = 0))

```

### Philippines

```{r}
vdemdata_long %>%
  filter(country_name == 'Philippines') %>% 
  ggplot(aes(x = year, y = score, color = criteria)) +
  geom_point() +
  geom_line() + 
  labs(title = 'Electoral Democracy in the Philippines from 1971 to 2022',
       subtitle = 'Trends in electoral democracy index scores over the last 50 years',
       x = 'Year',
       y = 'Index Score',
       color = 'Index',
       caption = 'Data Source: Varieties of Democracy (https://www.v-dem.net)') +
  scale_color_manual(values = c("#d8b365", "#2c7fb8", "#5ab4ac"),
                    labels = c('Clean election', 'Freedom of association', 'Freedom of expression')) + 
  theme_minimal() +
  theme(plot.caption = element_text(hjust = 0))
  
```

### United States

```{r}
vdemdata_long %>%
  filter(country_name == 'United States of America') %>% 
  ggplot(aes(x = year, y = score, color = criteria)) +
  geom_point() +
  geom_line() + 
  labs(title = 'Electoral Democracy in the USA from 1971 to 2022',
       subtitle = 'Trends in electoral democracy index scores over the last 50 years',
       x = 'Year',
       y = 'Index Score',
       color = 'Index',
       caption = 'Data Source: Varieties of Democracy (https://www.v-dem.net)') +
  scale_color_manual(values = c("#d8b365", "#2c7fb8", "#5ab4ac"),
                    labels = c('Clean election', 'Freedom of association', 'Freedom of expression')) + 
  theme_minimal() +
  theme(plot.caption = element_text(hjust = 0))
  
```

## Cross-Country Results

### Individual measures of electoral democracy

```{r}

#| Summary of individual measures of electoral democracy

indicators = c('clean_elections' = 'Clean election', 
               'freedom_association' = 'Freedom of association', 
               'freedom_expression' = 'Freedom of expression')

vdemdata_long %>%
  ggplot(aes(y = country_name, x = score)) +
  geom_bar(stat = "summary", fill = '#008080') +
  facet_wrap(~criteria, labeller = labeller(criteria = indicators)) +
  labs(title = 'Electoral democracy indicators in Bangladesh, Pakistan, Philippines, and USA', 
       subtitle = 'Comparison of individual index scores',
       x = 'Index Score',
       y = 'Country',
       caption = 'Data Source: Varieties of Democracy (https://www.v-dem.net)') +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0),
        plot.caption = element_text(hjust = 0))

```

### Aggregated measure of electoral democracy

```{r}
# calculate index score
vdemdata_scored <- vdemdata_long %>%
  pivot_wider( # convert the data to a wide format to convert all criteria back as columns 
    names_from = "criteria",
    values_from = "score",
  ) %>%
  mutate(electoral_democracy = (0.5 * # calculate based on VDEM formula of electoral democracy index
                                  (elected_index *
                                     clean_elections *
                                     freedom_association *
                                     freedom_expression *
                                     suffrage)) +
           (0.5 * ((.125 * elected_index) +
                     (.25*clean_elections) +
                     (.25 * freedom_association) +
                     (.125 * suffrage) +
                     (.25 * freedom_expression))))
```

```{r}
#| Descriptive statistics

vdemdata_scored %>%
  group_by(country_name) %>%
  summarise(yearly_average = mean(electoral_democracy),
            yearly_median = median(electoral_democracy),
            sd = sd(electoral_democracy),
            min = min(electoral_democracy),
            max = min(electoral_democracy))



```

```{r}
#| Aggregate score visualization

vdemdata_scored %>%
  ggplot(aes(x = year, y = electoral_democracy, color = country_name)) +
  geom_point() +
  geom_line() +
  theme_minimal()

```

# Discussion and Conclusion

# References
